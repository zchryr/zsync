# zsync

I created this project because I wanted to have more visibility into off-site backups that I'm running. I think [rsync](https://en.wikipedia.org/wiki/Rsync) is amazing, so that's why this is basically just a wrapper around it written in Python with some extra Mattermost notification functionality. I know [zsync](http://zsync.moria.org.uk/) already exists, but I named it this before realizing that, and mainly because my name starts with a z.

## Why To Use This

As mentioned the purpose of this project is to sync an on-site NAS, to an off-site NAS. The rsync arguments specified in the python script only move files that are not on the remote host. The real reason to use this, is to get some visibility into which files are transferred to the remote server. I invision this to be used in cron job / schedule, where a nightly backup is made to the off-site NAS.

## How To Run This
### docker-compose [option 1]
Using `docker-compose` you can use the example `docker-compose.yml` file includued in this repo. That file has the three volumes that you need to create and configure for this to work. I would recommend a command something like `docker-compose up && docker-compose down` to run this with compose.

### docker run [option 2]
If you would like to use a `docker run` command instead, here is an example
```
docker run --rm --name zsync \
-v /opt/zsync/args.json:/home/zsync/args.json:ro \
-v /opt/zsync/id_rsa:/home/zsync/.ssh/id_rsa:ro \
-v /opt/zsync/files-to-backup/:/home/zsync/local:ro \
zacharyr/zsync:latest
```

### args.json [required]
This is a file that you NEED to edit. This file is used the python script. The scripts will not run if you do not edit this file.

### SSH Authentication [required]
You need to run `ssh-keygen`, create a `id_rsa` and `id_rsa.pub` with an empty passphrase. I'm sure there is a better way doing authentication, but for now, this is how I've got this configured so it can be interactionless. Place the `id_rsa.pub` on the remote server in the `~/.ssh/authorized_keys` file.

## How To Build This Yourself
`docker build .`

---

### Random
You can run this without needing docker, I just wouldn't recommend it. But if you want to, you'll need Python3, to install the packages in the `requirements.txt` file, and to do the above steps (minus the docker stuff).

### The Future
I want to add more error checking/handling into this project. I'm sure I can also add a lot more visibility into things, so more to come on that.
I might add Slack functionality into this later.